Ticket Categories
Ticket Categories



GET
/api/tickets/categories
List ticket categories for a company (paginated)

Returns a paginated list of ticket categories for a specific company. All authenticated users can list categories. Categories are returned sorted by creation date (newest first). Optionally filter by active status. Each category includes the count of active tickets (open, pending, resolved) assigned to it. Pagination is included with links to navigate between pages.

Parameters
Try it out
Name	Description
company_id *
string($uuid)
(query)
UUID of the company to list categories for (required)

550e8400-e29b-41d4-a716-446655440000
is_active
string
(query)
Filter by active status. Accepts "true", "false", "1", or "0". Omit to return all categories.

Available values : true, false, 1, 0


true
per_page
integer
(query)
Number of categories per page (default: 15, min: 1, max: 100)

Default value : 15

15
page
integer
(query)
Page number (default: 1)

Default value : 1

1
Responses
Code	Description	Links
200
Categories list retrieved successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "success": true,
  "data": [
    {
      "id": "9b8c7d6e-5f4a-3b2c-1d0e-9f8e7d6c5b4a",
      "company_id": "550e8400-e29b-41d4-a716-446655440000",
      "name": "Soporte Técnico",
      "description": "Problemas técnicos con el sistema",
      "is_active": true,
      "created_at": "2025-11-16T10:30:00.000000Z",
      "active_tickets_count": 5
    }
  ],
  "meta": {
    "current_page": 1,
    "from": 1,
    "to": 15,
    "last_page": 2,
    "per_page": 15,
    "total": 30
  },
  "links": {
    "first": "http://localhost:8000/api/tickets/categories?page=1",
    "last": "http://localhost:8000/api/tickets/categories?page=2",
    "prev": null,
    "next": "http://localhost:8000/api/tickets/categories?page=2"
  }
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
422
Validation error (missing or invalid company_id, per_page, or page)

Media type

application/json
Example Value
Schema
{
  "message": "The company id field is required.",
  "errors": {
    "company_id": [
      "The company id field is required."
    ],
    "is_active": [
      "The selected is active is invalid."
    ],
    "per_page": [
      "The per page must be between 1 and 100."
    ],
    "page": [
      "The page must be at least 1."
    ]
  }
}
No links

POST
/api/tickets/categories
Create a new ticket category

Creates a new ticket category for the company associated with the authenticated COMPANY_ADMIN. The company_id is automatically obtained from the JWT token - do not include it in the request body. Category names must be unique within the company. New categories are created with is_active=true by default.

Parameters
Try it out
No parameters

Request body

application/json
Example Value
Schema
{
  "name": "Soporte Técnico",
  "description": "Problemas técnicos con el sistema"
}
Responses
Code	Description	Links
201
Category created successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "success": true,
  "message": "Category created successfully",
  "data": {
    "id": "9b8c7d6e-5f4a-3b2c-1d0e-9f8e7d6c5b4a",
    "company_id": "550e8400-e29b-41d4-a716-446655440000",
    "name": "Soporte Técnico",
    "description": "Problemas técnicos con el sistema",
    "is_active": true,
    "created_at": "2025-11-16T10:30:00.000000Z"
  }
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden (user does not have COMPANY_ADMIN role or invalid company context)

Media type

application/json
Example Value
Schema
{
  "success": false,
  "message": "Invalid company context"
}
No links
422
Validation error

Media type

application/json
Example Value
Schema
{
  "message": "The category name is required",
  "errors": {
    "name": [
      "A category with this name already exists in your company"
    ],
    "description": [
      "The description must not exceed 500 characters"
    ],
    "company_id": [
      "The company id field is prohibited."
    ]
  }
}
No links

PUT
/api/tickets/categories/{id}
Update a ticket category

Updates an existing ticket category. Only COMPANY_ADMIN of the same company can update categories. Partial updates are supported - send only the fields you want to update. Category names must remain unique within the company. The company_id cannot be changed (immutable).

Parameters
Try it out
Name	Description
id *
string($uuid)
(path)
UUID of the category to update

9b8c7d6e-5f4a-3b2c-1d0e-9f8e7d6c5b4a
Request body

application/json
Example Value
Schema
{
  "name": "Soporte Técnico Avanzado",
  "description": "Problemas técnicos complejos que requieren escalación",
  "is_active": true
}
Responses
Code	Description	Links
200
Category updated successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "success": true,
  "message": "Category updated successfully",
  "data": {
    "id": "9b8c7d6e-5f4a-3b2c-1d0e-9f8e7d6c5b4a",
    "company_id": "550e8400-e29b-41d4-a716-446655440000",
    "name": "Soporte Técnico Avanzado",
    "description": "Problemas técnicos complejos que requieren escalación",
    "is_active": true,
    "created_at": "2025-11-16T10:30:00.000000Z"
  }
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden (user does not have COMPANY_ADMIN role or category belongs to different company)

Media type

application/json
Example Value
Schema
{
  "success": false,
  "message": "Unauthorized"
}
No links
404
Category not found

Media type

application/json
Example Value
Schema
{
  "success": false,
  "message": "Category not found"
}
No links
422
Validation error

Media type

application/json
Example Value
Schema
{
  "message": "The category name must be at least 3 characters",
  "errors": {
    "name": [
      "A category with this name already exists in your company"
    ],
    "description": [
      "The description must not exceed 500 characters"
    ],
    "is_active": [
      "The is_active field must be true or false"
    ],
    "company_id": [
      "The company id field is prohibited."
    ]
  }
}
No links

DELETE
/api/tickets/categories/{id}
Delete a ticket category

Permanently deletes a ticket category. Only COMPANY_ADMIN of the same company can delete categories. Categories with active tickets (open, pending, or resolved status) cannot be deleted. This is a hard delete operation (not soft delete).

Parameters
Try it out
Name	Description
id *
string($uuid)
(path)
UUID of the category to delete

9b8c7d6e-5f4a-3b2c-1d0e-9f8e7d6c5b4a
Responses
Code	Description	Links
200
Category deleted successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "success": true,
  "message": "Category deleted successfully"
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden (user does not have COMPANY_ADMIN role or category belongs to different company)

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Category not found

Media type

application/json
Example Value
Schema
{
  "success": false,
  "message": "Category not found"
}
No links
422
Cannot delete category (has active tickets)

Media type

application/json
Example Value
Schema
{
  "success": false,
  "message": "Cannot delete category with 5 active tickets"
}
No links
Ticket Actions
Ticket Actions



POST
/api/tickets/{ticket}/resolve
Resolve a ticket

Marks a ticket as resolved by changing its status from OPEN or PENDING to RESOLVED. Sets the resolved_at timestamp. Only AGENT role users from the ticket's company can resolve tickets. Cannot resolve tickets that are already RESOLVED or CLOSED. Triggers TicketResolved event.

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
Request body

application/json
Optional resolution note

Example Value
Schema
{
  "resolution_note": "Issue was resolved by updating the database configuration."
}
Responses
Code	Description	Links
200
Ticket resolved successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "message": "Ticket marcado como resuelto exitosamente",
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "ticket_code": "TKT-2025-00001",
    "status": "resolved",
    "resolved_at": "2025-11-16T14:30:00+00:00"
  }
}
No links
400
Bad request - invalid state transition

Media type

application/json
Example Value
Schema
{
  "message": "El ticket ya está resuelto"
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden - user lacks AGENT role or does not belong to ticket company

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket not found

Media type

application/json
Example Value
Schema
{
  "message": "No query results for model [Ticket]."
}
No links
422
Validation error

Media type

application/json
Example Value
Schema
{
  "message": "The resolution note must not be greater than 5000 characters.",
  "errors": {
    "resolution_note": [
      "The resolution note must not be greater than 5000 characters."
    ]
  }
}
No links

POST
/api/tickets/{ticket}/close
Close a ticket

Closes a ticket by changing its status to CLOSED and setting closed_at timestamp. AGENT role users can close any ticket from their company regardless of current status. USER role (ticket creator) can only close tickets in RESOLVED status. Cannot close tickets that are already CLOSED. Triggers TicketClosed event.

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
Request body

application/json
Optional close note

Example Value
Schema
{
  "close_note": "Closing ticket as the issue has been resolved and confirmed by the user."
}
Responses
Code	Description	Links
200
Ticket closed successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "message": "Ticket cerrado exitosamente",
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "ticket_code": "TKT-2025-00001",
    "status": "closed",
    "closed_at": "2025-11-16T14:30:00+00:00"
  }
}
No links
400
Bad request - ticket already closed

Media type

application/json
Example Value
Schema
{
  "message": "El ticket ya está cerrado"
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden - USER can only close RESOLVED tickets, AGENT must belong to ticket company

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket not found

Media type

application/json
Example Value
Schema
{
  "message": "No query results for model [Ticket]."
}
No links
422
Validation error

Media type

application/json
Example Value
Schema
{
  "message": "The close note must not be greater than 5000 characters.",
  "errors": {
    "close_note": [
      "The close note must not be greater than 5000 characters."
    ]
  }
}
No links

POST
/api/tickets/{ticket}/reopen
Reopen a ticket

Reopens a ticket by changing its status from RESOLVED or CLOSED back to PENDING. Clears resolved_at and closed_at timestamps. Ticket creator (USER) can reopen within 30 days of closure. AGENT can reopen without time restrictions. Cannot reopen tickets in OPEN or PENDING status. Triggers TicketReopened event.

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
Request body

application/json
Optional reopen reason

Example Value
Schema
{
  "reopen_reason": "The issue has reoccurred and needs further investigation."
}
Responses
Code	Description	Links
200
Ticket reopened successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "message": "Ticket reabierto exitosamente",
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "ticket_code": "TKT-2025-00001",
    "status": "pending",
    "resolved_at": null,
    "closed_at": null
  }
}
No links
400
Bad request - invalid state for reopening

Media type

application/json
Example Value
Schema
{
  "message": "El ticket no puede ser reabierto"
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden - USER can only reopen within 30 days of closure, AGENT must belong to ticket company

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket not found

Media type

application/json
Example Value
Schema
{
  "message": "No query results for model [Ticket]."
}
No links
422
Validation error - reopen restrictions

Media type

application/json
Example Value
Schema
{
  "message": "The reopen reason must not be greater than 5000 characters.",
  "errors": {
    "can_reopen": [
      "No puedes reabrir un ticket cerrado después de 30 días."
    ],
    "reopen_reason": [
      "The reopen reason must not be greater than 5000 characters."
    ]
  }
}
No links

POST
/api/tickets/{ticket}/assign
Assign ticket to agent

Assigns a ticket to a specific agent by updating the owner_agent_id field. Only AGENT role users from the ticket's company can assign tickets. The target agent must have AGENT role and belong to the same company as the ticket. Triggers TicketAssigned event and sends notification to the assigned agent.

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
Request body

application/json
Agent assignment data

Example Value
Schema
{
  "new_agent_id": "660e8400-e29b-41d4-a716-446655440000",
  "assignment_note": "Assigning to John as he has expertise in database issues."
}
Responses
Code	Description	Links
200
Ticket assigned successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "message": "Ticket asignado exitosamente",
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "ticket_code": "TKT-2025-00001",
    "owner_agent_id": "660e8400-e29b-41d4-a716-446655440000",
    "owner_agent": {
      "id": "660e8400-e29b-41d4-a716-446655440000",
      "name": "John Doe"
    }
  }
}
No links
400
Bad request - invalid agent role or company mismatch

Media type

application/json
Example Value
Schema
{
  "message": "El usuario no tiene rol de agente o pertenece a otra empresa"
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden - user lacks AGENT role or does not belong to ticket company

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket or agent not found

Media type

application/json
Example Value
Schema
{
  "message": "No query results for model [Ticket]."
}
No links
422
Validation error

Media type

application/json
Example Value
Schema
{
  "message": "The new agent id field is required.",
  "errors": {
    "new_agent_id": [
      "The new agent id field is required.",
      "The new agent id must be a valid UUID.",
      "El usuario no tiene rol de agente o pertenece a otra empresa."
    ],
    "assignment_note": [
      "The assignment note must not be greater than 5000 characters."
    ]
  }
}
No links
Ticket Attachments
Ticket Attachments



GET
/api/tickets/{ticket}/attachments
List all ticket attachments

Retrieves all attachments for a ticket, including those attached to responses. Returns attachment metadata with uploader information. Attachments are ordered by creation date (oldest first). Authorization: ticket creator or AGENT from ticket's company can view attachments.

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
Responses
Code	Description	Links
200
List of attachments retrieved successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "data": [
    {
      "id": "770e8400-e29b-41d4-a716-446655440000",
      "ticket_id": "550e8400-e29b-41d4-a716-446655440000",
      "response_id": null,
      "uploaded_by_user_id": "660e8400-e29b-41d4-a716-446655440000",
      "uploaded_by_name": "John Doe",
      "file_name": "error_log.txt",
      "file_url": "tickets/attachments/1731774123_error_log.txt",
      "file_type": "txt",
      "file_size_bytes": 1024,
      "created_at": "2025-11-16T14:30:00+00:00"
    },
    {
      "id": "880e8400-e29b-41d4-a716-446655440000",
      "ticket_id": "550e8400-e29b-41d4-a716-446655440000",
      "response_id": "550e8400-e29b-41d4-a716-446655440001",
      "uploaded_by_user_id": "770e8400-e29b-41d4-a716-446655440000",
      "uploaded_by_name": "Jane Smith",
      "file_name": "solution_screenshot.png",
      "file_url": "tickets/attachments/1731774456_solution_screenshot.png",
      "file_type": "png",
      "file_size_bytes": 524288,
      "created_at": "2025-11-16T15:00:00+00:00"
    }
  ]
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden - user not authorized to view attachments

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket not found

Media type

application/json
Example Value
Schema
{
  "message": "No query results for model [Ticket]."
}
No links

POST
/api/tickets/{ticket}/attachments
Upload attachment to ticket

Uploads a file attachment to a ticket. Supports multipart/form-data uploads with file validation. Maximum file size is 10 MB. Only 5 attachments are allowed per ticket. Allowed file types: pdf, txt, log, doc, docx, xls, xlsx, csv (documents), jpg, jpeg, png, gif, bmp, webp, svg (images), mp4 (video). Optionally, a response_id can be provided to attach the file to a specific ticket response. Authorization: ticket creator or AGENT from ticket's company. Cannot upload to closed tickets.

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
Request body

multipart/form-data
File upload with optional response association

file *
string($binary)
File to upload (max 10MB). Allowed types: pdf, txt, log, doc, docx, xls, xlsx, csv, jpg, jpeg, png, gif, bmp, webp, svg, mp4

response_id
string($uuid)
Optional UUID of a ticket response to attach the file to. Must belong to this ticket. Only response author can upload within 30 minutes of response creation.

Responses
Code	Description	Links
200
File uploaded successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "message": "Archivo subido exitosamente",
  "data": {
    "id": "770e8400-e29b-41d4-a716-446655440000",
    "ticket_id": "550e8400-e29b-41d4-a716-446655440000",
    "response_id": null,
    "uploaded_by_user_id": "660e8400-e29b-41d4-a716-446655440000",
    "uploaded_by_name": "John Doe",
    "file_name": "screenshot.png",
    "file_url": "tickets/attachments/1731774123_screenshot.png",
    "file_type": "png",
    "file_size_bytes": 245760,
    "created_at": "2025-11-16T14:30:00+00:00"
  }
}
No links
400
Bad request - generic upload failure

Media type

application/json
Example Value
Schema
{
  "message": "Failed to upload attachment",
  "error": "Storage write failed"
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden - user not authorized to upload or ticket is closed

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket not found

Media type

application/json
Example Value
Schema
{
  "message": "No query results for model [Ticket]."
}
No links
413
Payload too large - file exceeds 10 MB limit

Media type

application/json
Example Value
Schema
{
  "message": "Validation failed",
  "errors": {
    "file": [
      "File size must not exceed 10 MB."
    ]
  }
}
No links
422
Validation error - invalid file type, max attachments exceeded, or invalid response_id

Media type

application/json
Example Value
Schema
{
  "message": "Validation failed",
  "errors": {
    "file": [
      "Invalid file type."
    ],
    "response_id": [
      "The selected response does not belong to this ticket."
    ]
  }
}
No links

POST
/api/tickets/{ticket}/responses/{response}/attachments
Upload attachment to specific response

Uploads a file attachment to a specific ticket response. Only the response author can upload attachments, and only within 30 minutes of response creation. Same file constraints apply: 10 MB max size, 5 attachments max per ticket, allowed file types. Useful for adding supporting documentation or evidence to a response after it was created.

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
response *
string($uuid)
(path)
UUID of the ticket response to attach the file to

550e8400-e29b-41d4-a716-446655440001
Request body

multipart/form-data
File to upload to the response

file *
string($binary)
File to upload (max 10MB). Allowed types: pdf, txt, log, doc, docx, xls, xlsx, csv, jpg, jpeg, png, gif, bmp, webp, svg, mp4

Responses
Code	Description	Links
200
File uploaded to response successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "message": "Archivo subido exitosamente",
  "data": {
    "id": "990e8400-e29b-41d4-a716-446655440000",
    "ticket_id": "550e8400-e29b-41d4-a716-446655440000",
    "response_id": "550e8400-e29b-41d4-a716-446655440001",
    "uploaded_by_user_id": "660e8400-e29b-41d4-a716-446655440000",
    "uploaded_by_name": "John Doe",
    "file_name": "config_backup.xlsx",
    "file_url": "tickets/attachments/1731774789_config_backup.xlsx",
    "file_type": "xlsx",
    "file_size_bytes": 98304,
    "created_at": "2025-11-16T16:00:00+00:00"
  }
}
No links
400
Bad request - generic upload failure

Media type

application/json
Example Value
Schema
{
  "message": "Failed to upload attachment",
  "error": "Storage write failed"
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden - not response author, outside 30-minute window, or ticket is closed

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket or response not found

Media type

application/json
Example Value
Schema
{
  "message": "No query results for model [TicketResponse]."
}
No links
413
Payload too large - file exceeds 10 MB limit

Media type

application/json
Example Value
Schema
{
  "message": "Validation failed",
  "errors": {
    "file": [
      "File size must not exceed 10 MB."
    ]
  }
}
No links
422
Validation error - response does not belong to ticket, invalid file type, or max attachments exceeded

Media type

application/json
Example Value
Schema
{
  "message": "Validation failed",
  "errors": {
    "response_id": [
      "The selected response does not belong to this ticket."
    ],
    "file": [
      "Invalid file type."
    ]
  }
}
No links

DELETE
/api/tickets/{ticket}/attachments/{attachment}
Delete a ticket attachment

Deletes an attachment from a ticket. Only the original uploader can delete the attachment, and only within 30 minutes of upload. The file is removed from storage and the database record is deleted. Cannot delete attachments from closed tickets.

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
attachment *
string($uuid)
(path)
UUID of the attachment to delete

770e8400-e29b-41d4-a716-446655440000
Responses
Code	Description	Links
200
Attachment deleted successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "message": "Archivo eliminado exitosamente"
}
No links
400
Bad request - deletion failed

Media type

application/json
Example Value
Schema
{
  "message": "Failed to delete attachment",
  "error": "Storage deletion failed"
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden - not uploader, outside 30-minute window, or ticket is closed

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket or attachment not found, or attachment does not belong to ticket

Media type

application/json
Example Value
Schema
{
  "message": "Attachment does not belong to this ticket."
}
No links

GET
/api/tickets/attachments/{attachment}/download
Download an attachment file

Downloads an attachment file. Returns the actual file as a binary stream with appropriate Content-Disposition header for browser download. The file is downloaded with its original filename. Authorization: ticket creator or AGENT from ticket's company can download attachments. Files are stored locally on the server.

Parameters
Try it out
Name	Description
attachment *
string($uuid)
(path)
UUID of the attachment to download

770e8400-e29b-41d4-a716-446655440000
Responses
Code	Description	Links
200
File download stream

Media type

application/octet-stream
Controls Accept header.
Example Value
Schema
string
Headers:
Name	Description	Type
Content-Disposition
File attachment with original filename

string
Example: attachment; filename="error_log.txt"
Content-Type
MIME type of the file

string
Example: application/octet-stream
Content-Length
Size of the file in bytes

integer
Example: 1024
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden - user not authorized to download attachments

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Attachment not found or file does not exist in storage

Media type

application/json
Example Value
Schema
{
  "message": "File not found"
}
No links
Tickets
Tickets



GET
/api/tickets
List tickets with role-based visibility

Returns paginated list of tickets with role-based filtering. USER sees only their own tickets. AGENT sees all tickets from their company. COMPANY_ADMIN sees all tickets from their company. Supports multiple filters, search, sorting, and pagination.

Parameters
Try it out
Name	Description
status
string
(query)
Filter by ticket status

Available values : open, pending, resolved, closed


--
category_id
string($uuid)
(query)
Filter by category UUID

category_id
owner_agent_id
string
(query)
Filter by assigned agent UUID. Use "null" for unassigned tickets, "me" for tickets assigned to authenticated user

550e8400-e29b-41d4-a716-446655440000
created_by_user_id
string($uuid)
(query)
Filter by creator user UUID

created_by_user_id
last_response_author_type
string
(query)
Filter by last response author type

Available values : none, user, agent


--
search
string
(query)
Search in ticket title and description (case-insensitive)

search
created_from
string($date)
(query)
Filter tickets created after this date (inclusive)

created_from
created_to
string($date)
(query)
Filter tickets created before this date (inclusive)

created_to
created_after
string($date)
(query)
Alternative to created_from (same behavior)

created_after
created_before
string($date)
(query)
Alternative to created_to (same behavior)

created_before
sort_by
string
(query)
Field to sort by

Available values : created_at, updated_at, title, status

Default value : created_at


created_at
sort_order
string
(query)
Sort direction

Available values : asc, desc

Default value : desc


desc
sort
string
(query)
Shorthand for sort_by (defaults to ascending). If provided without sort_order, will use "asc"

created_at
per_page
integer
(query)
Number of items per page

Default value : 15

15
page
integer
(query)
Page number for pagination

Default value : 1

1
Responses
Code	Description	Links
200
Tickets list with pagination

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "data": [
    {
      "id": "7c9e6679-7425-40de-944b-e07fc1f90ae7",
      "ticket_code": "TKT-2025-00001",
      "title": "Error al exportar reporte mensual",
      "status": "open",
      "last_response_author_type": "none",
      "company_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
      "category_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
      "created_by_user_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
      "owner_agent_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
      "creator_name": "Juan Pérez",
      "owner_agent_name": "María García",
      "category_name": "Problemas Técnicos",
      "created_by_user": {
        "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
        "name": "string",
        "email": "user@example.com"
      },
      "owner_agent": {
        "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
        "name": "string",
        "email": "user@example.com"
      },
      "category": {
        "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
        "name": "string"
      },
      "company": {
        "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
        "name": "string"
      },
      "responses_count": 3,
      "attachments_count": 1,
      "created_at": "2025-11-16T10:30:00+00:00",
      "updated_at": "2025-11-16T10:30:00+00:00"
    }
  ],
  "meta": {
    "current_page": 1,
    "total": 45,
    "per_page": 15,
    "last_page": 3
  }
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links

POST
/api/tickets
Create a new support ticket

Creates a new support ticket. Only users with USER role can create tickets. The ticket will be created with status "open" and a unique ticket_code (e.g., TKT-2025-00001) will be automatically generated. Requires JWT authentication with USER role.

Parameters
Try it out
No parameters

Request body

application/json
Example Value
Schema
{
  "title": "Error al exportar reporte mensual",
  "description": "Cuando intento exportar el reporte mensual de ventas, el sistema muestra un error 500. He intentado desde diferentes navegadores con el mismo resultado.",
  "company_id": "550e8400-e29b-41d4-a716-446655440000",
  "category_id": "9b8c7d6e-5f4a-3b2c-1d0e-9f8e7d6c5b4a"
}
Responses
Code	Description	Links
201
Ticket created successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "message": "Ticket creado exitosamente",
  "data": {
    "id": "7c9e6679-7425-40de-944b-e07fc1f90ae7",
    "ticket_code": "TKT-2025-00001",
    "company_id": "550e8400-e29b-41d4-a716-446655440000",
    "category_id": "9b8c7d6e-5f4a-3b2c-1d0e-9f8e7d6c5b4a",
    "created_by_user_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
    "owner_agent_id": null,
    "title": "Error al exportar reporte mensual",
    "description": "Cuando intento exportar el reporte mensual de ventas...",
    "status": "open",
    "last_response_author_type": "none",
    "resolved_at": null,
    "closed_at": null,
    "created_by_user": {
      "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
      "name": "Juan Pérez",
      "email": "juan.perez@example.com"
    },
    "owner_agent": null,
    "company": {
      "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
      "name": "Acme Corporation"
    },
    "category": {
      "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
      "name": "Problemas Técnicos"
    },
    "responses_count": 0,
    "attachments_count": 0,
    "timeline": {
      "created_at": "2025-11-16T10:30:00+00:00",
      "first_response_at": null,
      "resolved_at": null,
      "closed_at": null
    },
    "created_at": "2025-11-16T10:30:00+00:00",
    "updated_at": "2025-11-16T10:30:00+00:00"
  }
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden (user does not have USER role)

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
422
Validation error

Media type

application/json
Example Value
Schema
{
  "message": "The title field is required.",
  "errors": {
    "title": [
      "The title field is required."
    ],
    "description": [
      "The description must be at least 10 characters."
    ],
    "company_id": [
      "The selected company id is invalid."
    ],
    "category_id": [
      "La categoría seleccionada no está activa."
    ]
  }
}
No links

GET
/api/tickets/{ticket}
Get a single ticket by ticket_code

Returns detailed information about a specific ticket. Policy-based authorization: ticket creator can always view, agents and company admins can view tickets from their company. The ticket is identified by ticket_code (e.g., TKT-2025-00001) in the URL.

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
Responses
Code	Description	Links
200
Ticket details retrieved successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "data": {
    "id": "7c9e6679-7425-40de-944b-e07fc1f90ae7",
    "ticket_code": "TKT-2025-00001",
    "company_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
    "category_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
    "created_by_user_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
    "owner_agent_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
    "title": "Error al exportar reporte mensual",
    "description": "Cuando intento exportar el reporte mensual de ventas...",
    "status": "pending",
    "last_response_author_type": "agent",
    "resolved_at": null,
    "closed_at": null,
    "created_by_user": {
      "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
      "name": "Juan Pérez",
      "email": "juan.perez@example.com"
    },
    "owner_agent": {
      "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
      "name": "María García"
    },
    "company": {
      "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
      "name": "Acme Corporation"
    },
    "category": {
      "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
      "name": "Problemas Técnicos"
    },
    "responses_count": 3,
    "attachments_count": 1,
    "timeline": {
      "created_at": "2025-11-16T10:30:00+00:00",
      "first_response_at": "2025-11-16T11:15:00+00:00",
      "resolved_at": null,
      "closed_at": null
    },
    "created_at": "2025-11-16T10:30:00+00:00",
    "updated_at": "2025-11-16T12:45:00+00:00"
  }
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden (user does not have permission to view this ticket)

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket not found

Media type

application/json
Example Value
Schema
{
  "message": "No query results for model"
}
No links

DELETE
/api/tickets/{ticket}
Delete a ticket

Permanently deletes a ticket. Only COMPANY_ADMIN role can delete tickets. Policy-based authorization: ticket must be in "closed" status to be deleted. This is a hard delete operation (not soft delete).

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
Responses
Code	Description	Links
200
Ticket deleted successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "message": "Ticket eliminado exitosamente"
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden (user does not have COMPANY_ADMIN role, does not own the company, or ticket is not closed)

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket not found

Media type

application/json
Example Value
Schema
{
  "message": "No query results for model"
}
No links
422
Cannot delete ticket (ticket is not in closed status)

Media type

application/json
Example Value
Schema
{
  "message": "Only closed tickets can be deleted. Current status: pending"
}
No links

PATCH
/api/tickets/{ticket}
Update a ticket

Updates ticket properties. Policy-based authorization: ticket creator can update only if status is "open", agents and company admins can update tickets from their company. Only title and category_id can be updated. Partial updates are supported (send only fields to update).

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
Request body

application/json
Example Value
Schema
{
  "title": "Error al exportar reportes - Actualizado",
  "category_id": "8a7b6c5d-4e3f-2a1b-0c9d-8e7f6a5b4c3d"
}
Responses
Code	Description	Links
200
Ticket updated successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "message": "Ticket actualizado exitosamente",
  "data": {
    "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
    "ticket_code": "TKT-2025-00001",
    "company_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
    "category_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
    "created_by_user_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
    "owner_agent_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
    "title": "Error al exportar reportes - Actualizado",
    "description": "string",
    "status": "open",
    "last_response_author_type": "string",
    "resolved_at": "2025-11-21T03:13:42.665Z",
    "closed_at": "2025-11-21T03:13:42.665Z",
    "created_by_user": {},
    "owner_agent": {},
    "company": {},
    "category": {
      "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
      "name": "string"
    },
    "responses_count": 0,
    "attachments_count": 0,
    "timeline": {},
    "created_at": "2025-11-21T03:13:42.665Z",
    "updated_at": "2025-11-21T03:13:42.665Z"
  }
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden (user does not have permission to update this ticket or ticket status does not allow updates)

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket not found

Media type

application/json
Example Value
Schema
{
  "message": "No query results for model"
}
No links
422
Validation error

Media type

application/json
Example Value
Schema
{
  "message": "The title must be at least 5 characters.",
  "errors": {
    "title": [
      "The title must be at least 5 characters."
    ],
    "category_id": [
      "La categoría seleccionada no está activa."
    ]
  }
}
No links
Ticket Responses
Ticket Responses



GET
/api/tickets/{ticket}/responses
List all responses for a ticket

Returns all responses for a specific ticket ordered by created_at ASC (chronological conversation order). Ticket creator can view their ticket responses. AGENT role users can view responses for tickets in their company. Each response includes author information and any attachments.

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
Responses
Code	Description	Links
200
List of responses retrieved successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "data": [
    {
      "id": "9d8c7b6a-5e4f-3a2b-1c0d-9e8f7a6b5c4d",
      "ticket_id": "7c9e6679-7425-40de-944b-e07fc1f90ae7",
      "author_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
      "content": "Gracias por la respuesta. ¿Cuándo estará solucionado?",
      "author_type": "user",
      "author": {},
      "attachments": [
        {}
      ],
      "created_at": "2025-11-16T10:30:00+00:00",
      "updated_at": "2025-11-16T10:30:00+00:00"
    }
  ]
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden - user lacks permission to view this ticket's responses

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket not found

Media type

application/json
Example Value
Schema
{
  "message": "No query results for model [Ticket]."
}
No links

POST
/api/tickets/{ticket}/responses
Create a new response in a ticket

Creates a new response in a ticket. The author_type (user/agent) is automatically determined based on the authenticated user's JWT role. If an AGENT responds first, the ticket is auto-assigned to them via database trigger. Cannot respond to CLOSED tickets. Triggers ResponseAdded event. USER role: responds as "user" type. AGENT role: responds as "agent" type.

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
Request body

application/json
Example Value
Schema
{
  "content": "Gracias por contactarnos. He revisado su caso y el problema se debe a una configuración incorrecta en el módulo de exportación. Procederé a corregirlo inmediatamente."
}
Responses
Code	Description	Links
201
Response created successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "message": "Respuesta creada exitosamente",
  "data": {
    "id": "9d8c7b6a-5e4f-3a2b-1c0d-9e8f7a6b5c4d",
    "ticket_id": "7c9e6679-7425-40de-944b-e07fc1f90ae7",
    "author_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
    "content": "Gracias por contactarnos. He revisado su caso...",
    "author_type": "agent",
    "author": {
      "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
      "name": "María García",
      "email": "maria.garcia@company.com"
    },
    "attachments": [],
    "created_at": "2025-11-16T14:30:00+00:00",
    "updated_at": "2025-11-16T14:30:00+00:00"
  }
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden - user lacks permission to respond to this ticket OR ticket is closed

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket not found

Media type

application/json
Example Value
Schema
{
  "message": "No query results for model [Ticket]."
}
No links
422
Validation error

Media type

application/json
Example Value
Schema
{
  "message": "The content field is required.",
  "errors": {
    "content": [
      "The content field is required.",
      "The content must not be greater than 5000 characters."
    ]
  }
}
No links

GET
/api/tickets/{ticket}/responses/{response}
Get a single response by ID

Returns detailed information about a specific response including author details and attachments. Validates that the response belongs to the specified ticket. Ticket creator can view responses from their ticket. AGENT role users can view responses for tickets in their company.

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
response *
string($uuid)
(path)
Response UUID

9d8c7b6a-5e4f-3a2b-1c0d-9e8f7a6b5c4d
Responses
Code	Description	Links
200
Response details retrieved successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "data": {
    "id": "9d8c7b6a-5e4f-3a2b-1c0d-9e8f7a6b5c4d",
    "ticket_id": "7c9e6679-7425-40de-944b-e07fc1f90ae7",
    "author_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
    "content": "He identificado el problema. Procederé a solucionarlo.",
    "author_type": "agent",
    "author": {
      "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
      "name": "María García",
      "email": "maria.garcia@company.com"
    },
    "attachments": [
      {
        "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
        "ticket_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
        "response_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
        "uploaded_by_user_id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
        "uploaded_by_name": "María García",
        "file_name": "screenshot.png",
        "file_url": "/storage/tickets/attachments/abc123.png",
        "file_type": "image/png",
        "file_size_bytes": 245760,
        "created_at": "2025-11-21T03:13:42.674Z"
      }
    ],
    "created_at": "2025-11-16T11:15:00+00:00",
    "updated_at": "2025-11-16T11:15:00+00:00"
  }
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden - user lacks permission to view this ticket's responses

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket not found OR response does not belong to ticket

Media type

application/json
Example Value
Schema
{
  "message": "No query results for model [Ticket]."
}
No links

DELETE
/api/tickets/{ticket}/responses/{response}
Delete a response

Permanently deletes a response from a ticket. Only the original author can delete their response and only within 30 minutes of creation. Cannot delete responses in CLOSED tickets. This is a hard delete operation.

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
response *
string($uuid)
(path)
Response UUID

9d8c7b6a-5e4f-3a2b-1c0d-9e8f7a6b5c4d
Responses
Code	Description	Links
200
Response deleted successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "message": "Respuesta eliminada exitosamente"
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden - user is not the author, 30 minute window expired, or ticket is closed

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket or response not found

Media type

application/json
Example Value
Schema
{
  "message": "No query results for model [Ticket]."
}
No links

PATCH
/api/tickets/{ticket}/responses/{response}
Update a response

Updates the content of a response. Only the original author can update their response and only within 30 minutes of creation. Cannot update responses in CLOSED tickets. The author_type cannot be changed.

Parameters
Try it out
Name	Description
ticket *
string
(path)
Ticket code (e.g., TKT-2025-00001)

TKT-2025-00001
response *
string($uuid)
(path)
Response UUID

9d8c7b6a-5e4f-3a2b-1c0d-9e8f7a6b5c4d
Request body

application/json
Example Value
Schema
{
  "content": "He identificado el problema y ya está corregido. Por favor intenta nuevamente. Si el error persiste, adjunta una captura de pantalla."
}
Responses
Code	Description	Links
200
Response updated successfully

Media type

application/json
Controls Accept header.
Example Value
Schema
{
  "message": "Respuesta actualizada exitosamente",
  "data": {
    "id": "9d8c7b6a-5e4f-3a2b-1c0d-9e8f7a6b5c4d",
    "ticket_id": "7c9e6679-7425-40de-944b-e07fc1f90ae7",
    "author_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
    "content": "He identificado el problema y ya está corregido...",
    "author_type": "agent",
    "author": {},
    "attachments": [
      {}
    ],
    "created_at": "2025-11-16T11:15:00+00:00",
    "updated_at": "2025-11-16T11:30:00+00:00"
  }
}
No links
401
Unauthenticated (missing or invalid JWT token)

Media type

application/json
Example Value
Schema
{
  "message": "Unauthenticated"
}
No links
403
Forbidden - user is not the author, 30 minute window expired, or ticket is closed

Media type

application/json
Example Value
Schema
{
  "message": "This action is unauthorized."
}
No links
404
Ticket or response not found

Media type

application/json
Example Value
Schema
{
  "message": "No query results for model [Ticket]."
}
No links
422
Validation error

Media type

application/json
Example Value
Schema
{
  "message": "The content field is required.",
  "errors": {
    "content": [
      "The content field is required.",
      "The content must not be greater than 5000 characters."
    ]
  }
}
