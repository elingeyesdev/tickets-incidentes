# üì¢ REGLAS: SEEDERS DE ANUNCIOS
## Enterprise Helpdesk System

---

## üéØ OBJETIVO

Crear anuncios realistas que simulen comunicaciones reales de empresas a sus usuarios, conectados con incidentes, mantenimientos y eventos del sistema.

---

## ‚öôÔ∏è CONFIGURACI√ìN

```
PER√çODO:    5 enero 2025 - 8 diciembre 2025
VOLUMEN:    10-30 anuncios por empresa
TIPOS:      4 tipos obligatorios (MAINTENANCE, INCIDENT, NEWS, ALERT)
```

### Idempotencia
```php
if (CompanyAnnouncement::where('company_id', $company->id)->exists()) {
    return; // Ya existen anuncios
}
```

---

## üìã TIPOS DE ANUNCIOS (4 Obligatorios)

### 1. MAINTENANCE (Mantenimientos)
**Distribuci√≥n:** 25-30% del total

**Metadata requerida:**
```json
{
  "urgency": "LOW|MEDIUM|HIGH",
  "scheduled_start": "2025-06-15T02:00:00Z",
  "scheduled_end": "2025-06-15T06:00:00Z",
  "actual_start": "2025-06-15T02:05:00Z",    // Si ya ocurri√≥
  "actual_end": "2025-06-15T05:45:00Z",      // Si ya ocurri√≥
  "is_emergency": false,
  "affected_services": ["banca_online", "app_movil"]
}
```

**Patrones:**
- 70% programados (scheduled_start en futuro o pasado reciente)
- 30% emergencias (is_emergency: true)
- Horarios nocturnos: 80% entre 00:00-06:00
- Horarios diurnos: 20% (solo emergencias)
- Duraci√≥n t√≠pica: 2-6 horas

### 2. INCIDENT (Incidentes)
**Distribuci√≥n:** 20-25% del total

**Metadata requerida:**
```json
{
  "urgency": "MEDIUM|HIGH|CRITICAL",
  "resolution_content": "Servicios restaurados. Causa: sobrecarga de red...",
  "affected_services": ["red_norte", "atencion_clientes"],
  "started_at": "2025-08-10T09:15:00Z",
  "resolved_at": "2025-08-10T11:30:00Z"      // Si ya fue resuelto
}
```

**Patrones:**
- 60% resueltos (con resolved_at)
- 40% en curso (sin resolved_at, en el pasado reciente)
- Duraci√≥n: 30 min - 6 horas
- Horarios pico: 9:00-11:00 AM, 2:00-4:00 PM

### 3. NEWS (Noticias)
**Distribuci√≥n:** 35-40% del total

**Metadata requerida:**
```json
{
  "news_type": "feature_release|policy_update|general_update",
  "target_audience": "all_users|premium_users|business_clients",
  "summary": "Breve resumen de 2-3 l√≠neas",
  "call_to_action": "Actualiza tu app ahora"
}
```

**Patrones:**
- 50% feature_release (nuevas funcionalidades)
- 30% policy_update (cambios de pol√≠ticas)
- 20% general_update (comunicados generales)

### 4. ALERT (Alertas)
**Distribuci√≥n:** 10-15% del total

**Metadata requerida:**
```json
{
  "urgency": "HIGH|CRITICAL",
  "alert_type": "security|system|service|compliance",
  "message": "Mensaje corto y directo",
  "action_required": true,
  "action_description": "Actualiza tu contrase√±a antes del 20/12",
  "started_at": "2025-11-01T00:00:00Z",
  "ended_at": "2025-12-20T23:59:59Z",        // Deadline
  "affected_services": ["todos"]
}
```

**Patrones:**
- 70% action_required: true
- 60% security alerts
- 40% system/service/compliance
- Duraci√≥n activa: 7-30 d√≠as

---

## üìä ESTADOS DE PUBLICACI√ìN

### Distribuci√≥n
```
PUBLISHED:  75-80%  - Visible para usuarios
SCHEDULED:  10-15%  - Programados (futuro cercano)
DRAFT:      5-10%   - En edici√≥n
ARCHIVED:   0-5%    - Antiguos archivados
```

### Reglas
- **PUBLISHED:** `published_at` en el pasado
- **SCHEDULED:** `published_at` en el futuro (pr√≥ximos 7-30 d√≠as)
- **DRAFT:** `published_at = null`
- **ARCHIVED:** Anuncios publicados hace +6 meses

---

## üîó COHERENCIA CON TICKETS

### Patr√≥n 1: Incidente Masivo
```
09:15 - INCIDENT PUBLISHED
        "Ca√≠da del servicio - En resoluci√≥n"
        urgency: CRITICAL
        
09:20 - 8-12 TICKETS similares
        "No puedo acceder"
        "Error en el sistema"
        
11:30 - INCIDENT UPDATED
        + resolution_content: "Restaurado"
        + resolved_at: now()
```

### Patr√≥n 2: Mantenimiento Programado
```
Lunes 10:00 - MAINTENANCE SCHEDULED
              "Mantenimiento s√°bado 2am-6am"
              scheduled_for: s√°bado futuro
              
S√°bado 02:00 - (Ejecutar mantenimiento)
               actual_start registrado
               
S√°bado 05:45 - actual_end registrado

Lunes 08:30 - 2-4 TICKETS
              "¬øYa termin√≥ el mantenimiento?"
```

### Patr√≥n 3: Nueva Funcionalidad
```
01/08 - NEWS PUBLISHED
        "Nueva funci√≥n: Pagos QR"
        news_type: feature_release
        
03/08 - 6-10 TICKETS
        "¬øC√≥mo usar QR?"
        "No encuentro la funci√≥n"
        
05/08 - ART√çCULO Help Center
        "Gu√≠a: Pagos con c√≥digo QR"
```

### Patr√≥n 4: Alerta de Seguridad
```
01/11 - ALERT PUBLISHED
        "Actualiza tu contrase√±a"
        urgency: HIGH
        action_required: true
        ended_at: 20/12
        
02/11 - 15-20 TICKETS
        "¬øC√≥mo cambiar contrase√±a?"
        "Error al actualizar"
        
05/11 - ART√çCULO Help Center
        "Cambio de contrase√±a segura"
```

---

## üìÖ DISTRIBUCI√ìN TEMPORAL

### Por Trimestre (2025)
```
Q1 2025 (Ene-Mar):  20%  - Lanzamiento y ajustes iniciales
Q2 2025 (Abr-Jun):  25%  - Incremento de actividad
Q3 2025 (Jul-Sep):  30%  - Pico de actividad y nuevas funciones
Q4 2025 (Oct-Dic):  25%  - Estabilizaci√≥n y cierres
```

### Horarios por Tipo
```
MAINTENANCE:
- 80% entre 00:00-06:00 (madrugada)
- 20% entre 10:00-18:00 (solo emergencias)

INCIDENT:
- 40% entre 09:00-11:00 (ma√±ana)
- 35% entre 14:00-16:00 (tarde)
- 25% horarios variados

NEWS:
- 60% entre 08:00-10:00 (inicio jornada)
- 40% entre 14:00-17:00 (tarde)

ALERT:
- 70% entre 08:00-12:00 (alta visibilidad)
- 30% horarios variados
```

---

---

## ‚úÖ CHECKLIST DE CALIDAD

### Antes de Generar
```
‚òê Verificar que NO existan anuncios previos (idempotencia)
‚òê Identificar industria de la empresa
‚òê Revisar tickets existentes para coherencia
‚òê Definir servicios cr√≠ticos de la empresa (affected_services)
```

### Durante Generaci√≥n
```
‚òê Volumen: 10-30 anuncios
‚òê Distribuci√≥n de tipos: 25% MAINT, 22% INC, 38% NEWS, 12% ALERT
‚òê Estados: 77% PUBLISHED, 12% SCHEDULED, 8% DRAFT, 3% ARCHIVED
‚òê Fechas dentro del rango (5 ene 2025 - 8 dic 2025)
‚òê Metadata completa seg√∫n tipo
‚òê affected_services espec√≠ficos de la industria
‚òê Horarios coherentes con tipo de anuncio
```

### Validaciones Cr√≠ticas
```
‚òê SCHEDULED: published_at en el futuro
‚òê PUBLISHED: published_at en el pasado
‚òê MAINTENANCE: scheduled_start < scheduled_end
‚òê MAINTENANCE pasados: actual_start y actual_end presentes
‚òê INCIDENT resueltos: resolved_at presente
‚òê ALERT: ended_at en el futuro o pasado reciente
‚òê No anuncios publicados despu√©s de 8 dic 2025
```

---

## üé® BUENAS PR√ÅCTICAS

### T√≠tulos
- Claros y espec√≠ficos: "Mantenimiento banca online - S√°bado 15/06"
- No gen√©ricos: ‚ùå "Mantenimiento del sistema"
- Incluir fecha si aplica
- M√°ximo 80 caracteres

### Contenido
- Primera l√≠nea: Resumen del qu√© y cu√°ndo
- Segunda parte: Detalles y afectaciones
- Tercera parte: Qu√© hacer o esperar
- Tono profesional pero accesible
- 100-500 palabras

### affected_services
- Nombres espec√≠ficos: "banca_online", "cajeros_zona_norte"
- No gen√©ricos: ‚ùå "sistema", "plataforma"
- Relacionados con la industria
- Array con 1-4 servicios

### Urgency Levels
```
LOW:      Informativo, sin afectaci√≥n cr√≠tica
MEDIUM:   Afectaci√≥n moderada, puede esperar
HIGH:     Requiere atenci√≥n pronta
CRITICAL: Urgente, afectaci√≥n severa
```

---

## üìù ESTRUCTURA DEL SEEDER

```php
class [Company]AnnouncementsSeeder extends Seeder
{
    public function run(): void
    {
        $company = Company::where('name', 'Nombre')->first();
        
        // Idempotencia
        if (CompanyAnnouncement::where('company_id', $company->id)->exists()) {
            return;
        }

        $announcements = [
            // MAINTENANCE (25-30%)
            [
                'type' => 'MAINTENANCE',
                'title' => '...',
                'content' => '...',
                'status' => 'PUBLISHED',
                'metadata' => [
                    'urgency' => 'MEDIUM',
                    'scheduled_start' => '2025-06-15T02:00:00Z',
                    'scheduled_end' => '2025-06-15T06:00:00Z',
                    'actual_start' => '2025-06-15T02:05:00Z',
                    'actual_end' => '2025-06-15T05:50:00Z',
                    'is_emergency' => false,
                    'affected_services' => ['banca_online', 'app_movil']
                ],
                'created_at' => '2025-06-10 10:00:00',
                'published_at' => '2025-06-10 10:30:00'
            ],
            
            // INCIDENT (20-25%)
            [
                'type' => 'INCIDENT',
                'title' => '...',
                'content' => '...',
                'status' => 'PUBLISHED',
                'metadata' => [
                    'urgency' => 'HIGH',
                    'resolution_content' => 'Servicios restaurados...',
                    'affected_services' => ['red_zona_sur'],
                    'started_at' => '2025-08-10T09:15:00Z',
                    'resolved_at' => '2025-08-10T11:30:00Z'
                ],
                'created_at' => '2025-08-10 09:20:00',
                'published_at' => '2025-08-10 09:25:00'
            ],
            
            // NEWS (35-40%)
            [
                'type' => 'NEWS',
                'title' => '...',
                'content' => '...',
                'status' => 'PUBLISHED',
                'metadata' => [
                    'news_type' => 'feature_release',
                    'target_audience' => 'all_users',
                    'summary' => 'Breve resumen...',
                    'call_to_action' => 'Actualiza tu app'
                ],
                'created_at' => '2025-08-01 08:00:00',
                'published_at' => '2025-08-01 08:30:00'
            ],
            
            // ALERT (10-15%)
            [
                'type' => 'ALERT',
                'title' => '...',
                'content' => '...',
                'status' => 'PUBLISHED',
                'metadata' => [
                    'urgency' => 'CRITICAL',
                    'alert_type' => 'security',
                    'message' => 'Actualiza tu contrase√±a',
                    'action_required' => true,
                    'action_description' => 'Cambio obligatorio...',
                    'started_at' => '2025-11-01T00:00:00Z',
                    'ended_at' => '2025-12-20T23:59:59Z',
                    'affected_services' => ['todos']
                ],
                'created_at' => '2025-10-28 09:00:00',
                'published_at' => '2025-11-01 00:00:00'
            ]
        ];

        foreach ($announcements as $data) {
            CompanyAnnouncement::create([
                'company_id' => $company->id,
                'author_id' => $company->admin_user_id,
                'type' => $data['type'],
                'title' => $data['title'],
                'content' => $data['content'],
                'status' => $data['status'],
                'metadata' => $data['metadata'],
                'published_at' => $data['published_at'],
                'created_at' => $data['created_at'],
                'updated_at' => $data['created_at']
            ]);
        }
    }
}
```

---

## üéØ M√âTRICAS DE √âXITO

```
‚úì 10-30 anuncios por empresa
‚úì Los 4 tipos presentes (MAINTENANCE, INCIDENT, NEWS, ALERT)
‚úì Metadata completa y coherente
‚úì Fechas realistas y ordenadas
‚úì Conexi√≥n con tickets (2-3 escenarios m√≠nimo)
‚úì affected_services espec√≠ficos de industria
‚úì 0 anuncios en el futuro despu√©s de 8 dic 2025
‚úì Estados coherentes con fechas
```

---

**VERSI√ìN:** 1.0  
**FECHA:** 8 Diciembre 2025  
**ESTADO:** Producci√≥n ‚úì
