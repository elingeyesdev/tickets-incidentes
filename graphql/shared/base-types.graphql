# ================================================================================
# TIPOS BASE COMPARTIDOS - Sistema Helpdesk V9.0
# Tipos básicos simplificados para EVITAR LOOPS INFINITOS
# ================================================================================

"""
Información de usuario para contexto de autenticación
Usado en AuthPayload y AuthStatus
"""
type UserAuthInfo {
  """ID único del usuario"""
  id: UUID!

  """Código único legible del usuario"""
  userCode: String! @rename(attribute: "user_code")

  """Email del usuario"""
  email: Email!

  """Email verificado"""
  emailVerified: Boolean! @rename(attribute: "email_verified")

  """Onboarding completado (completar perfil + configurar preferencias)"""
  onboardingCompleted: Boolean! @field(resolver: "App\\Shared\\GraphQL\\Resolvers\\OnboardingCompletedResolver")

  """Estado actual del usuario"""
  status: UserStatus!

  """Nombre para mostrar (firstName + lastName)"""
  displayName: String! @field(resolver: "App\\Shared\\GraphQL\\Resolvers\\DisplayNameResolver")

  """URL del avatar del usuario"""
  avatarUrl: URL @field(resolver: "App\\Shared\\GraphQL\\Resolvers\\AvatarUrlResolver")

  """Tema de interfaz preferido"""
  theme: String! @field(resolver: "App\\Shared\\GraphQL\\Resolvers\\ThemeResolver")

  """Idioma preferido"""
  language: String! @field(resolver: "App\\Shared\\GraphQL\\Resolvers\\LanguageResolver")

  """
  Contextos de roles disponibles del usuario
  Resuelve automáticamente los roles activos con sus empresas asociadas
  Usa DataLoader para prevenir N+1 queries
  """
  roleContexts: [RoleContext!]! @field(resolver: "App\\Features\\UserManagement\\GraphQL\\Types\\UserFieldResolvers@roleContexts")
}

"""
Type mínimo de usuario para referencias
Usado en assignedBy, revokedBy, y otras referencias simples
"""
type UserMinimal {
  """ID único del usuario"""
  id: UUID!

  """Código único legible del usuario"""
  userCode: String!

  """Email del usuario"""
  email: Email!

  """Nombre para mostrar (firstName + lastName)"""
  displayName: String!

  """URL del avatar del usuario"""
  avatarUrl: URL
}

"""
Información básica de usuario (versión con status)
Usar en relaciones donde se necesita conocer el estado
NO incluye relaciones complejas ni listas anidadas
"""
type UserBasicInfo {
  """ID único del usuario"""
  id: UUID!

  """Código único legible del usuario"""
  userCode: String!

  """Email del usuario"""
  email: Email!

  """Nombre para mostrar (firstName + lastName)"""
  displayName: String!

  """URL del avatar del usuario"""
  avatarUrl: URL

  """Estado actual del usuario"""
  status: UserStatus!
}

"""
Información mínima de empresa para referencias y selectores
Usar en relaciones para evitar loops infinitos
NO incluye listas de usuarios, agentes o tickets
"""
type CompanyMinimal {
  """ID único de la empresa"""
  id: UUID!

  """Código único legible de la empresa"""
  companyCode: String! @rename(attribute: "company_code")

  """Nombre comercial de la empresa"""
  name: String!

  """URL del logo de la empresa"""
  logoUrl: URL @rename(attribute: "logo_url")
}

"""
Información de empresa en contexto de rol
Usado exclusivamente en RoleContext
"""
type RoleCompanyContext {
  """ID único de la empresa"""
  id: UUID!

  """Código único legible de la empresa"""
  companyCode: String!

  """Nombre comercial de la empresa"""
  name: String!

  """URL del logo de la empresa"""
  logoUrl: URL
}

"""
Información de rol para selector y permisos
Usado en AuthPayload.roleContexts y User.roleContexts
SIN over-fetching: company es opcional según rol
"""
type RoleContext {
  """Código del rol"""
  roleCode: RoleCode!

  """Nombre del rol"""
  roleName: String!

  """
  Información de empresa (presente SOLO si el rol requiere empresa)
  Campo resuelto manualmente en cada feature
  """
  company: RoleCompanyContext

  """Ruta del dashboard correspondiente al rol"""
  dashboardPath: String!
}

"""
Información básica de ticket (versión simplificada)
Usar en relaciones para evitar loops infinitos
NO incluye respuestas ni archivos adjuntos
"""
type TicketBasicInfo {
  """ID único del ticket"""
  id: UUID!

  """Código único legible del ticket"""
  ticketCode: String!

  """Título del ticket"""
  title: String!

  """Estado actual del ticket"""
  status: TicketStatus!

  """Prioridad del ticket"""
  priority: TicketPriority!

  """Fecha de creación"""
  createdAt: DateTime!
}